/* eslint-disable */
Component({
  data: {
    count: '',
    flag: null
  },
  props: {
    data: {},
    onFinish: function onFinish() {},
    containerClassName: ''
  },
  didMount: function didMount() {
    var _this = this;

    var waitingTime = this.props.data.waitingTime; // 默认 15 秒

    this.setData({
      count: waitingTime ? waitingTime : 15
    }, function () {
      // 300 毫秒之后再开始执行，让用户感知到开始时间
      var flag = setTimeout(function () {
        _this.setTime();
      }, 300);
      flag = null;
    });
  },
  didUpdate: function didUpdate() {},
  didUnmount: function didUnmount() {
    this.clear();
  },
  methods: {
    setTime: function setTime() {
      var _this2 = this;

      if (this.data.count === 0) {
        this.clear();
        var onFinish = this.props.onFinish;
        onFinish('End of countdown');
        return;
      } else {
        this.setData({
          count: this.data.count - 1
        });
      }

      var flag = setTimeout(function () {
        _this2.setTime();
      }, 1000);
      this.setData({
        flag: flag
      });
    },
    clear: function clear() {
      clearTimeout(this.data.flag);
      this.setData({
        flag: null
      });
    }
  }
});